<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airline Labor Cost Analysis Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: linear-gradient(135deg, #c41e3a, #e85a4f);
            color: white;
            border-radius: 15px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 20px;
            flex-wrap: wrap;
        }

        .tab-button {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            font-size: 1rem;
            transition: all 0.3s ease;
            min-width: 180px;
            text-align: center;
        }

        .tab-button.active {
            background: #c41e3a;
            color: white;
            border-color: #c41e3a;
        }

        .tab-button:hover {
            background: #e9ecef;
            border-color: #c41e3a;
        }

        .tab-button.active:hover {
            background: #c41e3a;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .input-section {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .input-section h3 {
            color: #c41e3a;
            margin-bottom: 15px;
            font-size: 1.2rem;
            border-bottom: 2px solid #c41e3a;
            padding-bottom: 8px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #c41e3a, #dc3545);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
            min-width: 200px;
        }

        .format-controls {
            text-align: center;
            margin: 20px 0;
            flex-wrap: wrap;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .format-controls label {
            font-weight: 600;
            color: #495057;
            margin: 0;
        }

        .format-btn {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            white-space: nowrap;
        }

        .format-btn.active {
            background: #c41e3a;
            color: white;
            border-color: #c41e3a;
        }

        .results {
            display: none;
            margin-top: 40px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: white;
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-left: 5px solid #c41e3a;
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #c41e3a;
            margin-bottom: 8px;
            word-break: break-word;
            line-height: 1.2;
        }

        .metric-label {
            font-size: 0.85rem;
            color: #6c757d;
            font-weight: 500;
            line-height: 1.3;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            margin-top: 30px;
            overflow-x: auto;
        }

        .chart-container h3 {
            color: #c41e3a;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.3rem;
        }

        .year-bar {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 8px;
            min-width: 500px;
        }

        .year-label {
            width: 80px;
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .bar-container {
            position: relative;
            height: 20px;
            margin: 0 10px;
            width: 300px;
            border-radius: 10px;
            flex-shrink: 0;
        }

        .bar-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            border: 1px solid #ccc;
        }

        .bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 20px;
            background: linear-gradient(90deg, #c41e3a, #dc3545);
            border-radius: 10px;
            z-index: 10;
            min-width: 3px;
        }

        .bar-value {
            font-weight: 600;
            color: #495057;
            font-size: 0.85rem;
            flex: 1;
            text-align: left;
        }

        .impact-analysis, .competitive-analysis {
            padding: 20px;
            margin-top: 20px;
            border-radius: 15px;
        }

        .impact-analysis {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 2px solid #ffc107;
        }

        .competitive-analysis {
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
            border: 2px solid #17a2b8;
        }

        .impact-analysis h3, .competitive-analysis h3 {
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .impact-item {
            margin: 8px 0;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .peer-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }

        .peer-card {
            background: rgba(255, 255, 255, 0.8);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            font-size: 0.85rem;
        }

        .methodology-section {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .methodology-section h3 {
            color: #c41e3a;
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 2px solid #c41e3a;
            padding-bottom: 8px;
        }

        .formula-box {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 12px;
            margin: 12px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            overflow-x: auto;
        }

        .assumption-item {
            margin: 8px 0;
            padding: 10px;
            background: linear-gradient(135deg, #e3f2fd, #f1f8e9);
            border-radius: 8px;
            border-left: 4px solid #2196f3;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        /* Mobile-specific improvements */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 10px;
            }
            
            .header {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .tab-button {
                font-size: 0.9rem;
                padding: 10px 16px;
                min-width: 140px;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .metric-value {
                font-size: 1.5rem;
            }
            
            .year-bar {
                flex-direction: column;
                align-items: stretch;
                min-width: auto;
                gap: 8px;
            }
            
            .year-label {
                width: auto;
                text-align: center;
            }
            
            .bar-container {
                width: 100%;
                margin: 0;
            }
            
            .bar-value {
                text-align: center;
                font-size: 0.8rem;
            }
            
            .format-controls {
                flex-direction: column;
                gap: 8px;
            }
            
            .peer-comparison {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 10px;
                margin: 5px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .input-section {
                padding: 15px;
            }
            
            .calculate-btn {
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .chart-container {
                padding: 15px;
            }
            
            .methodology-section {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>✈️ FALCON</h1>
            <p>Financial Analysis Labor Cost Optimization Navigator</p>
        </div>

        <div class="tabs">
            <button class="tab-button active" data-tab="tool">📊 Analysis Tool</button>
            <button class="tab-button" data-tab="methodology">📋 Methodology & Formulas</button>
        </div>

        <div class="tab-panel active" id="tool">
            <div class="input-grid">
                <div class="input-section">
                    <h3>📊 Current Labor Metrics</h3>
                    <div class="form-group">
                        <label for="employeeType">Employee Type:</label>
                        <select id="employeeType">
                            <option value="pilot_widebody">Pilot - Wide Body</option>
                            <option value="pilot_narrowbody">Pilot - Narrow Body</option>
                            <option value="flight_attendant">Flight Attendant</option>
                            <option value="ground_crew">Ground Crew</option>
                            <option value="maintenance">Maintenance Technician</option>
                            <option value="customer_service">Customer Service</option>
                            <option value="corporate" selected>Corporate/Administrative</option>
                            <option value="all_employees">All Employees (Blended)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="currentEmployees">Total Employees in Category:</label>
                        <input type="number" id="currentEmployees" value="15000" min="100" max="95000">
                    </div>
                    <div class="form-group">
                        <label for="avgSalary">Average Annual Salary ($):</label>
                        <input type="number" id="avgSalary" value="85000" min="30000" max="350000">
                    </div>
                    <div class="form-group">
                        <label for="benefitsRate">Benefits Rate (% of salary):</label>
                        <input type="number" id="benefitsRate" value="10" min="5" max="50" step="0.1">
                    </div>
                </div>

                <div class="input-section">
                    <h3>📈 Salary Increase Analysis</h3>
                    <div class="form-group">
                        <label for="salaryIncrease">Annual Salary Increase (%):</label>
                        <input type="number" id="salaryIncrease" value="5.0" min="0" max="15" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="projectionYears">Projection Period (years):</label>
                        <select id="projectionYears">
                            <option value="3">3 Years</option>
                            <option value="5" selected>5 Years</option>
                            <option value="7">7 Years</option>
                            <option value="10">10 Years</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="inflationRate">Expected Inflation Rate (%):</label>
                        <input type="number" id="inflationRate" value="2.8" min="0" max="8" step="0.1">
                    </div>
                </div>

                <div class="input-section">
                    <h3>🎯 Strategic Assumptions</h3>
                    <div class="form-group">
                        <label for="headcountGrowth">Annual Headcount Growth (%):</label>
                        <input type="number" id="headcountGrowth" value="0.0" min="-5" max="10" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="attritionRate">Annual Attrition Rate (%):</label>
                        <input type="number" id="attritionRate" value="0.0" min="0" max="25" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="contractType">Contract Negotiation Type:</label>
                        <select id="contractType">
                            <option value="standard">Standard Negotiation</option>
                            <option value="aggressive">Aggressive Terms</option>
                            <option value="conservative">Conservative Approach</option>
                        </select>
                    </div>
                </div>
            </div>

            <button class="calculate-btn" onclick="runAnalysis()">🚀 Run Financial Analysis</button>

            <div class="format-controls">
                <label style="font-weight: 600; margin-right: 15px; color: #495057;">Number Format:</label>
                <button class="format-btn active" id="fullFormat">Full Numbers</button>
                <button class="format-btn" id="shortFormat">Short Format (1.2M)</button>
            </div>

            <div class="results" id="results">
                <div class="results-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="totalCostYear1">$0</div>
                        <div class="metric-label">Year 1 Total Labor Cost</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="totalCostFinal">$0</div>
                        <div class="metric-label" id="finalYearLabel">Final Year Total Cost</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="cumulativeIncrease">$0</div>
                        <div class="metric-label">Cumulative Cost Increase</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="perEmployeeImpact">$0</div>
                        <div class="metric-label">Per Employee Annual Impact</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="attritionImpact">$0</div>
                        <div class="metric-label">Total Attrition Cost Impact</div>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>📊 Year-over-Year Labor Cost Projection</h3>
                    <div id="costChart"></div>
                </div>

                <div class="impact-analysis">
                    <h3>💡 Strategic Impact Analysis</h3>
                    <div id="impactDetails"></div>
                </div>

                <div class="competitive-analysis">
                    <h3>🏆 Industry Competitive Positioning</h3>
                    <p><strong>Benchmarking Analysis:</strong> Comparison with major airline peers</p>
                    <div class="peer-comparison" id="peerComparison"></div>
                </div>
            </div>
        </div>

        <div class="tab-panel" id="methodology">
            <div class="methodology-section">
                <h3>📊 Core Calculations</h3>
                
                <h4>Total Compensation Formula:</h4>
                <div class="formula-box">
                    Total Compensation = Base Salary × (1 + Benefits Rate)
                    <br><br>
                    Example: $85,000 × (1 + 10%) = $93,500 per employee
                </div>
                
                <h4>Year-over-Year Projections:</h4>
                <div class="formula-box">
                    <strong>Step 1: Calculate Salary Growth</strong><br>
                    Year N Salary = Base Salary × (1 + Annual Increase)^N<br><br>
                    
                    <strong>Step 2: Calculate Headcount Growth</strong><br>
                    Year N Employees = Base Employees × (1 + Headcount Growth)^N<br><br>
                    
                    <strong>Step 3: Calculate Total Compensation</strong><br>
                    Year N Total Compensation = Year N Salary × (1 + Benefits Rate)<br><br>
                    
                    <strong>Step 4: Calculate Final Cost</strong><br>
                    Year N Total Cost = Year N Employees × Year N Total Compensation<br><br>
                    
                    <em>Example for Year 3:</em><br>
                    • Salary: $85,000 × (1.05)³ = $98,398<br>
                    • Employees: 15,000 × (1.00)³ = 15,000<br>
                    • Total Comp: $98,398 × 1.10 = $108,238<br>
                    • Total Cost: 15,000 × $108,238 = $1.62B
                </div>
            </div>

            <div class="methodology-section">
                <h3>💰 Attrition Cost Modeling</h3>
                
                <h4>When Attrition Rate > 0%, we calculate:</h4>
                <div class="formula-box">
                    Employees Lost = Employee Count × Attrition Rate
                    <br><br>
                    Replacement Cost = Employees Lost × (25% of Salary)
                    Training Cost = Employees Lost × $15,000
                    Productivity Loss = Employees Lost × (15% of Salary)
                    <br><br>
                    Total Attrition Cost = Replacement + Training + Productivity Loss
                </div>
                
                <div class="assumption-item">
                    <strong>Why these numbers?</strong> Industry research shows replacing an employee typically costs 25% of their salary (recruiting, interviewing, onboarding). Training costs average $15K per hire in airlines. New employees take 3-6 months to reach full productivity (15% loss).
                </div>
            </div>

            <div class="methodology-section">
                <h3>📈 Strategic Analysis</h3>
                
                <h4>Real Wage Growth:</h4>
                <div class="formula-box">
                    Real Growth = Salary Increase Rate - Inflation Rate
                    <br><br>
                    Example: 5% increase - 2.8% inflation = +2.2% real growth
                </div>
                
                <h4>Contract Strategy Impact:</h4>
                <div class="formula-box">
                    Conservative Strategy: Final Cost × 0.92 (8% reduction)
                    Standard Strategy: Final Cost × 1.0 (no change)
                    Aggressive Strategy: Final Cost × 1.15 (15% increase)
                </div>
                
                <div class="assumption-item">
                    <strong>Contract Strategy Logic:</strong> Conservative negotiations focus on controlling costs through tighter work rules. Aggressive strategies include premium benefits and flexible work arrangements that add hidden costs beyond base salary.
                </div>
            </div>

            <div class="methodology-section">
                <h3>🏆 Competitive Benchmarking</h3>
                
                <div class="assumption-item">
                    <strong>Data Sources:</strong> Competitive salary data is based on publicly available information including:
                    <ul style="margin-top: 10px;">
                        <li>Union contract announcements and press releases</li>
                        <li>Industry salary surveys and reports</li>
                        <li>SEC filings and annual reports</li>
                        <li>Aviation industry publications</li>
                    </ul>
                </div>
                
                <div class="assumption-item">
                    <strong>Employee Categories:</strong>
                    <ul style="margin-top: 10px;">
                        <li><strong>Wide Body Pilots:</strong> Fly international routes (B777, B787)</li>
                        <li><strong>Narrow Body Pilots:</strong> Domestic/short-haul routes (B737, A320 family)</li>
                        <li><strong>Flight Attendants:</strong> All aircraft types</li>
                        <li><strong>Ground Crew:</strong> Ramp operations, baggage handling</li>
                        <li><strong>Maintenance:</strong> Aircraft technicians and mechanics</li>
                        <li><strong>Customer Service:</strong> Gate agents, reservations, customer care</li>
                        <li><strong>Corporate:</strong> Administrative, management, support functions</li>
                    </ul>
                </div>
            </div>

            <div class="methodology-section">
                <h3>⚠️ Key Assumptions & Limitations</h3>
                
                <div class="assumption-item">
                    <strong>Simplified Model:</strong> This tool provides directional analysis for strategic planning. Real-world labor economics include additional factors like overtime, shift differentials, pension contributions, and regional pay variations.
                </div>
                
                <div class="assumption-item">
                    <strong>Benefits Rate:</strong> Default 10% represents basic benefits. Actual airline benefits typically range from 25-45% including health insurance, retirement contributions, flight benefits, and other perquisites.
                </div>
                
                <div class="assumption-item">
                    <strong>Competitive Data:</strong> Peer salary data represents estimates based on available public information. Actual compensation may vary based on seniority, location, aircraft type, and contract specifics.
                </div>
                
                <div class="assumption-item">
                    <strong>Time Value:</strong> All projections are in nominal dollars (not adjusted for inflation). For net present value analysis, discount future costs using appropriate cost of capital.
                </div>
            </div>
        </div>
    </div>

    <script>
        var currentFormat = 'full';

        // Tab switching functionality
        document.addEventListener('DOMContentLoaded', function() {
            var tabButtons = document.querySelectorAll('.tab-button');
            var tabPanels = document.querySelectorAll('.tab-panel');

            tabButtons.forEach(function(button) {
                button.addEventListener('click', function() {
                    var targetTab = this.getAttribute('data-tab');
                    
                    // Remove active class from all buttons
                    tabButtons.forEach(function(btn) {
                        btn.classList.remove('active');
                    });
                    
                    // Remove active class from all panels
                    tabPanels.forEach(function(panel) {
                        panel.classList.remove('active');
                    });
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Add active class to target panel
                    document.getElementById(targetTab).classList.add('active');
                });
            });

            // Format button functionality
            document.getElementById('fullFormat').addEventListener('click', function() {
                setNumberFormat('full');
            });

            document.getElementById('shortFormat').addEventListener('click', function() {
                setNumberFormat('short');
            });

            // Employee type change handler
            document.getElementById('employeeType').addEventListener('change', function() {
                updateEmployeeDefaults();
            });

            // Initialize defaults and run analysis
            updateEmployeeDefaults();
            runAnalysis();
        });

        function formatCurrency(amount) {
            if (currentFormat === 'short') {
                return formatCurrencyShort(amount);
            }
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function formatCurrencyShort(amount) {
            var absAmount = Math.abs(amount);
            if (absAmount >= 1000000000) {
                return '$' + (amount / 1000000000).toFixed(1) + 'B';
            } else if (absAmount >= 1000000) {
                return '$' + (amount / 1000000).toFixed(1) + 'M';
            } else if (absAmount >= 1000) {
                return '$' + (amount / 1000).toFixed(0) + 'K';
            } else {
                return '$' + amount.toFixed(0);
            }
        }

        function setNumberFormat(format) {
            currentFormat = format;
            
            document.getElementById('fullFormat').classList.remove('active');
            document.getElementById('shortFormat').classList.remove('active');
            document.getElementById(format + 'Format').classList.add('active');
            
            runAnalysis();
        }

        function updateEmployeeDefaults() {
            var employeeType = document.getElementById('employeeType').value;
            var employeeCountInput = document.getElementById('currentEmployees');
            var avgSalaryInput = document.getElementById('avgSalary');
            var benefitsRateInput = document.getElementById('benefitsRate');
            
            var defaults = {
                pilot_widebody: { count: 3500, salary: 285000, benefits: 10, attrition: 0 },
                pilot_narrowbody: { count: 8500, salary: 195000, benefits: 10, attrition: 0 },
                flight_attendant: { count: 26000, salary: 65000, benefits: 10, attrition: 0 },
                ground_crew: { count: 18000, salary: 48000, benefits: 10, attrition: 0 },
                maintenance: { count: 12000, salary: 78000, benefits: 10, attrition: 0 },
                customer_service: { count: 15000, salary: 42000, benefits: 10, attrition: 0 },
                corporate: { count: 15000, salary: 85000, benefits: 10, attrition: 0 },
                all_employees: { count: 95000, salary: 75000, benefits: 10, attrition: 0 }
            };
            
            var selected = defaults[employeeType];
            if (selected) {
                employeeCountInput.value = selected.count;
                avgSalaryInput.value = selected.salary;
                benefitsRateInput.value = selected.benefits;
                document.getElementById('attritionRate').value = selected.attrition;
                
                if (employeeType.indexOf('pilot') >= 0) {
                    avgSalaryInput.min = 150000;
                    avgSalaryInput.max = 350000;
                } else {
                    avgSalaryInput.min = 30000;
                    avgSalaryInput.max = 200000;
                }
            }
        }

        function runAnalysis() {
            var currentEmployees = parseInt(document.getElementById('currentEmployees').value);
            var avgSalary = parseInt(document.getElementById('avgSalary').value);
            var benefitsRate = parseFloat(document.getElementById('benefitsRate').value) / 100;
            var salaryIncrease = parseFloat(document.getElementById('salaryIncrease').value) / 100;
            var projectionYears = parseInt(document.getElementById('projectionYears').value);
            var inflationRate = parseFloat(document.getElementById('inflationRate').value) / 100;
            var headcountGrowth = parseFloat(document.getElementById('headcountGrowth').value) / 100;
            var attritionRate = parseFloat(document.getElementById('attritionRate').value) / 100;
            var contractType = document.getElementById('contractType').value;

            var totalCompensation = avgSalary * (1 + benefitsRate);
            var baseLaborCost = currentEmployees * totalCompensation;

            var projections = [];
            var cumulativeIncrease = 0;
            var cumulativeAttritionCost = 0;

            for (var year = 1; year <= projectionYears; year++) {
                var employeeCount = Math.round(currentEmployees * Math.pow(1 + headcountGrowth, year));
                var adjustedSalary = avgSalary * Math.pow(1 + salaryIncrease, year);
                var adjustedTotalComp = adjustedSalary * (1 + benefitsRate);
                var yearlyLaborCost = employeeCount * adjustedTotalComp;
                
                var employeesLost = Math.round(employeeCount * attritionRate);
                var replacementCost = employeesLost * (adjustedSalary * 0.25);
                var trainingCost = employeesLost * 15000;
                var productivityLoss = employeesLost * (adjustedSalary * 0.15);
                var totalAttritionCost = replacementCost + trainingCost + productivityLoss;
                
                cumulativeAttritionCost += totalAttritionCost;
                
                projections.push({
                    year: year,
                    employeeCount: employeeCount,
                    avgSalary: adjustedSalary,
                    totalCost: yearlyLaborCost,
                    attritionCost: totalAttritionCost,
                    employeesLost: employeesLost
                });

                if (year > 1) {
                    cumulativeIncrease += (yearlyLaborCost - baseLaborCost);
                }
            }

            document.getElementById('totalCostYear1').textContent = formatCurrency(projections[0].totalCost);
            document.getElementById('totalCostFinal').textContent = formatCurrency(projections[projections.length - 1].totalCost);
            document.getElementById('finalYearLabel').textContent = 'Year ' + projectionYears + ' Total Cost';
            document.getElementById('cumulativeIncrease').textContent = formatCurrency(cumulativeIncrease);
            document.getElementById('perEmployeeImpact').textContent = formatCurrency((projections[projections.length - 1].totalCost - baseLaborCost) / currentEmployees);
            document.getElementById('attritionImpact').textContent = formatCurrency(cumulativeAttritionCost);

            createCostChart(projections, baseLaborCost);
            generateImpactAnalysis(projections, salaryIncrease, inflationRate, contractType, cumulativeAttritionCost, attritionRate);
            generateCompetitiveAnalysis(avgSalary);

            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function createCostChart(projections, baseLaborCost) {
            var chartContainer = document.getElementById('costChart');
            var maxCost = projections[projections.length - 1].totalCost;
            
            var chartHTML = '<div class="year-bar"><div class="year-label">Base Year</div><div class="bar-container"><div class="bar-background"></div><div class="bar" style="width: ' + ((baseLaborCost / maxCost) * 100) + '%"></div></div><div class="bar-value">' + formatCurrency(baseLaborCost) + '</div></div>';

            for (var i = 0; i < projections.length; i++) {
                var projection = projections[i];
                var barWidth = (projection.totalCost / maxCost) * 100;
                var growthPercent = ((projection.totalCost - baseLaborCost) / baseLaborCost * 100).toFixed(1);
                chartHTML += '<div class="year-bar"><div class="year-label">Year ' + projection.year + '</div><div class="bar-container"><div class="bar-background"></div><div class="bar" style="width: ' + barWidth + '%"></div></div><div class="bar-value">' + formatCurrency(projection.totalCost) + ' <small style="color: #c41e3a;">(+' + growthPercent + '%)</small></div></div>';
            }

            chartContainer.innerHTML = chartHTML;
        }

        function generateImpactAnalysis(projections, salaryIncrease, inflationRate, contractType, cumulativeAttritionCost, attritionRate) {
            var container = document.getElementById('impactDetails');
            
            if (!container || !projections || projections.length === 0) {
                return;
            }
            
            var finalProjection = projections[projections.length - 1];
            var baseProjection = projections[0];
            
            // Fix: Calculate total cost growth from base year to final year, not year 1 to final year
            var baseCost = parseInt(document.getElementById('currentEmployees').value) * 
                          parseInt(document.getElementById('avgSalary').value) * 
                          (1 + parseFloat(document.getElementById('benefitsRate').value) / 100);
            
            var totalGrowth = ((finalProjection.totalCost - baseCost) / baseCost) * 100;
            
            var wageVsInflation = salaryIncrease - inflationRate;
            var isPositiveRealGrowth = wageVsInflation > 0;
            var realGrowthDescription = isPositiveRealGrowth ? 'providing meaningful employee value and maintaining purchasing power' : 'resulting in declining purchasing power - potential retention risk';

            var contractMultiplier = 1.0;
            var contractDescription = '';
            
            if (contractType === 'aggressive') {
                contractMultiplier = 1.15;
                contractDescription = 'Aggressive negotiation may increase costs by 15% due to additional concessions';
            } else if (contractType === 'conservative') {
                contractMultiplier = 0.92;
                contractDescription = 'Conservative approach may reduce costs by 8% through careful negotiation';
            } else {
                contractDescription = 'Standard negotiation approach with balanced risk/reward profile';
            }

            var adjustedFinalCost = finalProjection.totalCost * contractMultiplier;

            var htmlContent = '<div class="impact-item"><strong>Real Wage Growth Impact:</strong> ' + (wageVsInflation * 100).toFixed(1) + '% ' + (isPositiveRealGrowth ? 'above' : 'below') + ' inflation rate, ' + realGrowthDescription + '</div>';
            htmlContent += '<div class="impact-item"><strong>Total Cost Growth:</strong> ' + totalGrowth.toFixed(1) + '% increase over ' + projections.length + ' years (from base year to year ' + projections.length + ')</div>';
            htmlContent += '<div class="impact-item"><strong>Contract Strategy:</strong> ' + contractDescription + '</div>';
            htmlContent += '<div class="impact-item"><strong>Board Recommendation:</strong> Estimated final year cost with strategy: ' + formatCurrency(adjustedFinalCost);
            
            if (!isPositiveRealGrowth) {
                htmlContent += ' <span style="color: #dc3545; font-weight: bold;">⚠️ Warning: Negative real wage growth may impact employee retention</span>';
            }
            htmlContent += '</div>';

            if (attritionRate > 0) {
                var attritionImpactOnRate = wageVsInflation < 0 ? attritionRate * 1.3 : attritionRate * 0.9;
                var potentialSavings = cumulativeAttritionCost * 0.4;
                htmlContent += '<div class="impact-item"><strong>Attrition Risk Assessment:</strong> Current ' + (attritionRate * 100).toFixed(1) + '% rate ' + (!isPositiveRealGrowth ? 'may increase to ' + (attritionImpactOnRate * 100).toFixed(1) + '% with negative real wages' : 'may improve with competitive compensation') + '</div>';
                htmlContent += '<div class="impact-item"><strong>Attrition Cost Impact:</strong> ' + formatCurrency(cumulativeAttritionCost) + ' total cost over ' + projections.length + ' years. Potential savings of ' + formatCurrency(potentialSavings) + ' with improved retention strategies.</div>';
            }

            container.innerHTML = htmlContent;
        }

        function generateCompetitiveAnalysis(avgSalary) {
            var container = document.getElementById('peerComparison');
            var employeeType = document.getElementById('employeeType').value;
            
            var peers = [];
            
            if (employeeType === 'pilot_widebody') {
                peers = [
                    { name: 'Delta Air Lines', avgSalary: 305000, increase: 4.2, source: 'APA Contract 2024' },
                    { name: 'United Airlines', avgSalary: 295000, increase: 4.8, source: 'ALPA Agreement 2024' },
                    { name: 'FedEx (Cargo)', avgSalary: 325000, increase: 5.5, source: 'Industry Survey 2024' },
                    { name: 'Southwest Airlines', avgSalary: 245000, increase: 5.2, source: 'SWAPA Contract 2024' }
                ];
            } else if (employeeType === 'pilot_narrowbody') {
                peers = [
                    { name: 'Delta Air Lines', avgSalary: 205000, increase: 4.0, source: 'APA Contract 2024' },
                    { name: 'United Airlines', avgSalary: 198000, increase: 4.5, source: 'ALPA Agreement 2024' },
                    { name: 'Southwest Airlines', avgSalary: 235000, increase: 5.8, source: 'SWAPA Contract 2024' },
                    { name: 'JetBlue Airways', avgSalary: 165000, increase: 3.8, source: 'Market Report 2024' }
                ];
            } else if (employeeType === 'flight_attendant') {
                peers = [
                    { name: 'Delta Air Lines', avgSalary: 68000, increase: 4.0, source: 'AFA Contract 2024' },
                    { name: 'United Airlines', avgSalary: 62000, increase: 4.5, source: 'AFA Agreement 2024' },
                    { name: 'Southwest Airlines', avgSalary: 72000, increase: 5.2, source: 'TWU Contract 2024' },
                    { name: 'JetBlue Airways', avgSalary: 58000, increase: 3.5, source: 'Salary Survey 2024' }
                ];
            } else if (employeeType === 'ground_crew') {
                peers = [
                    { name: 'Delta Air Lines', avgSalary: 52000, increase: 3.8, source: 'IAM Contract 2024' },
                    { name: 'United Airlines', avgSalary: 49000, increase: 4.2, source: 'IBT Agreement 2024' },
                    { name: 'Southwest Airlines', avgSalary: 55000, increase: 4.8, source: 'TWU Contract 2024' },
                    { name: 'JetBlue Airways', avgSalary: 46000, increase: 3.2, source: 'Market Data 2024' }
                ];
            } else if (employeeType === 'maintenance') {
                peers = [
                    { name: 'Delta Air Lines', avgSalary: 82000, increase: 3.5, source: 'IAM Contract 2024' },
                    { name: 'United Airlines', avgSalary: 79000, increase: 4.0, source: 'IBT Agreement 2024' },
                    { name: 'Southwest Airlines', avgSalary: 88000, increase: 4.8, source: 'AMFA Contract 2024' },
                    { name: 'Boeing (MRO)', avgSalary: 95000, increase: 3.8, source: 'IAM Survey 2024' }
                ];
            } else if (employeeType === 'customer_service') {
                peers = [
                    { name: 'Delta Air Lines', avgSalary: 45000, increase: 3.5, source: 'CWA Contract 2024' },
                    { name: 'United Airlines', avgSalary: 43000, increase: 3.8, source: 'IBT Agreement 2024' },
                    { name: 'Southwest Airlines', avgSalary: 47000, increase: 4.2, source: 'TWU Contract 2024' },
                    { name: 'JetBlue Airways', avgSalary: 41000, increase: 3.0, source: 'PayScale Data 2024' }
                ];
            } else if (employeeType === 'corporate') {
                peers = [
                    { name: 'Delta Air Lines', avgSalary: 92000, increase: 3.2, source: 'Glassdoor Report 2024' },
                    { name: 'United Airlines', avgSalary: 88000, increase: 3.5, source: 'Salary.com Survey 2024' },
                    { name: 'Southwest Airlines', avgSalary: 85000, increase: 4.0, source: 'Indeed Analysis 2024' },
                    { name: 'JetBlue Airways', avgSalary: 78000, increase: 2.8, source: 'ZipRecruiter 2024' }
                ];
            } else {
                peers = [
                    { name: 'Delta Air Lines', avgSalary: 78000, increase: 3.8, source: 'BLS Report 2024' },
                    { name: 'United Airlines', avgSalary: 75000, increase: 4.1, source: 'DOT Filing 2024' },
                    { name: 'Southwest Airlines', avgSalary: 82000, increase: 4.5, source: '10-K Report 2024' },
                    { name: 'JetBlue Airways', avgSalary: 68000, increase: 3.2, source: 'SEC Filing 2024' }
                ];
            }

            var peerHTML = '';
            for (var i = 0; i < peers.length; i++) {
                var peer = peers[i];
                var comparison = peer.avgSalary > avgSalary ? '📈' : peer.avgSalary < avgSalary ? '📉' : '➡️';
                var diffPercent = ((peer.avgSalary - avgSalary) / avgSalary * 100).toFixed(1);
                var diffText = peer.avgSalary > avgSalary ? '+' + diffPercent + '%' : diffPercent + '%';
                
                peerHTML += '<div class="peer-card"><h4>' + comparison + ' ' + peer.name + '</h4><p><strong>Market Rate:</strong> ' + formatCurrency(peer.avgSalary) + '</p><p><strong>Annual Increase:</strong> ' + peer.increase + '%</p><p><strong>vs Input:</strong> <span style="color: ' + (peer.avgSalary > avgSalary ? 'red' : 'green') + '">' + diffText + '</span></p><small style="color: #666; font-style: italic;">' + peer.source + '</small></div>';
            }

            container.innerHTML = peerHTML;
        }
    </script>
</body>
</html>
